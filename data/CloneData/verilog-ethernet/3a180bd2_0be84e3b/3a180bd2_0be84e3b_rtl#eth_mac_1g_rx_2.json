{"Source Block": ["verilog-ethernet/rtl/eth_mac_1g_rx.v@108:174@HdlStmProcess", "    .data_in(gmii_rxd_d4),\n    .crc_state(crc_state),\n    .crc_next(crc_next)\n);\n\nalways @* begin\n    state_next = STATE_IDLE;\n\n    reset_crc = 0;\n    update_crc = 0;\n\n    output_axis_tdata_next = 0;\n    output_axis_tvalid_next = 0;\n    output_axis_tlast_next = 0;\n    output_axis_tuser_next = 0;\n\n    error_bad_frame_next = 0;\n    error_bad_fcs_next = 0;\n\n    case (state_reg)\n        STATE_IDLE: begin\n            // idle state - wait for packet\n            reset_crc = 1;\n\n            if (gmii_rx_dv_d4 && ~gmii_rx_er_d4 && gmii_rxd_d4 == 8'hD5) begin\n                state_next = STATE_PAYLOAD;\n            end else begin\n                state_next = STATE_IDLE;\n            end\n        end\n        STATE_PAYLOAD: begin\n            // read payload\n            update_crc = 1;\n\n            output_axis_tdata_next = gmii_rxd_d4;\n            output_axis_tvalid_next = 1;\n\n            if (gmii_rx_er) begin\n                // error\n                output_axis_tlast_next = 1;\n                output_axis_tuser_next = 1;\n                error_bad_frame_next = 1;\n                state_next = STATE_IDLE;\n            end if (~gmii_rx_dv) begin\n                // end of packet\n                output_axis_tlast_next = 1;\n                if ({gmii_rxd_d0, gmii_rxd_d1, gmii_rxd_d2, gmii_rxd_d3} == ~crc_next) begin\n                    // FCS good\n                    output_axis_tuser_next = 0;\n                end else begin\n                    // FCS bad\n                    output_axis_tuser_next = 1;\n                    error_bad_frame_next = 1;\n                    error_bad_fcs_next = 1;\n                end\n                state_next = STATE_IDLE;\n            end else begin\n                state_next = STATE_PAYLOAD;\n            end\n        end\n    endcase\nend\n\nalways @(posedge clk) begin\n    if (rst) begin\n        state_reg <= STATE_IDLE;\n\n"], "Clone Blocks": [], "Diff Content": {"Delete": [[145, "            if (gmii_rx_er) begin\n"], [150, "                state_next = STATE_IDLE;\n"], [151, "            end if (~gmii_rx_dv) begin\n"]], "Add": [[145, "            if (gmii_rx_dv & gmii_rx_er) begin\n"], [151, "                state_next = STATE_WAIT_LAST;\n"], [151, "            end else if (~gmii_rx_dv) begin\n"], [167, "        STATE_WAIT_LAST: begin\n"], [167, "            if (~gmii_rx_dv) begin\n"], [167, "                state_next = STATE_IDLE;\n"], [167, "            end else begin\n"], [167, "                state_next = STATE_WAIT_LAST;\n"], [167, "            end\n"], [167, "        end\n"]]}}