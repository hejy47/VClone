{"Source Block": ["zipcpu/rtl/core/dblfetch.v@93:149@HdlStmProcess", "\treg\tcache_read_addr, cache_write_addr;\n\treg\t[1:0]\t\tcache_valid;\n\n\tinitial\to_wb_cyc = 1'b0;\n\tinitial\to_wb_stb = 1'b0;\n\talways @(posedge i_clk)\n\t\tif ((i_rst)||(i_wb_err))\n\t\tbegin\n\t\t\to_wb_cyc <= 1'b0;\n\t\t\to_wb_stb <= 1'b0;\n\t\t\t// last_stb <= 1'b0;\n\t\t\t// last_ack <= 1'b0;\n\t\tend else if (o_wb_cyc)\n\t\tbegin\n\t\t\tif ((o_wb_stb)&&(!i_wb_stall))\n\t\t\tbegin\n\t\t\t\t// last_stb <= 1'b1;\n\t\t\t\to_wb_stb <= !last_stb;\n\t\t\tend\n\t\t\t// if (i_wb_ack)\n\t\t\t//\tlast_ack <= 1'b1;\n\t\t\tif ((i_new_pc)||(invalid_bus_cycle))\n\t\t\t\to_wb_stb <= 1'b0;\n\n\t\t\tif ((i_wb_ack)&&(\n\t\t\t\t// Relase the bus on the second ack\n\t\t\t\t(last_ack)\n\t\t\t\t// Or on the first ACK, if we've been told\n\t\t\t\t// we have an invalid bus cycle\n\t\t\t\t||((o_wb_stb)&&(i_wb_stall)&&(last_stb)&&(\n\t\t\t\t\t(i_new_pc)||(invalid_bus_cycle)))\n\t\t\t\t))\n\t\t\tbegin\n\t\t\t\to_wb_cyc <= 1'b0;\n\t\t\t\to_wb_stb <= 1'b0;\n\t\t\tend\n\n\t\t\tif ((!last_stb)&&(i_wb_stall)&&((i_new_pc)||(invalid_bus_cycle)))\n\t\t\t\t// Also release the bus with no acks, if we\n\t\t\t\t// haven't made any requests\n\t\t\tbegin\n\t\t\t\to_wb_cyc <= 1'b0;\n\t\t\t\to_wb_stb <= 1'b0;\n\t\t\tend\n\t\tend else if ((invalid_bus_cycle)\n\t\t\t||((o_v)&&(i_stall_n)&&(cache_read_addr))) // Initiate a bus cycle\n\t\tbegin\n\t\t\to_wb_cyc <= 1'b1;\n\t\t\to_wb_stb <= 1'b1;\n\t\t\t// last_stb <= 1'b0;\n\t\t\t// last_ack <= 1'b0;\n\t\tend\n\n\tinitial\tlast_stb = 1'b0;\n\talways @(posedge i_clk)\n\t\tif ((o_wb_cyc)&&(o_wb_stb)&&(!i_wb_stall))\n\t\t\tlast_stb <= 1'b1;\n"], "Clone Blocks": [], "Diff Content": {"Delete": [[108, "\t\t\tbegin\n"], [111, "\t\t\tend\n"], [130, "\t\t\tif ((!last_stb)&&(i_wb_stall)&&((i_new_pc)||(invalid_bus_cycle)))\n"]], "Add": [[130, "\t\t\tif ((!last_stb)&&(i_wb_stall)\n"], [130, "\t\t\t\t\t&&((i_new_pc)||(invalid_bus_cycle)))\n"]]}}