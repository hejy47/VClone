{"Source Block": ["zipcpu/rtl/core/dcache.v@194:267@HdlStmProcess", "\tinitial\tr_cachable = 1'b0;\n\tinitial\tr_svalid = 1'b0;\n\tinitial\tr_dvalid = 1'b0;\n\tinitial\tr_cache_miss = 1'b0;\n\tinitial\tr_addr = 0;\n\talways @(posedge i_clk)\n\tif (i_reset)\n\tbegin\n\t\tr_rd <= 1'b0;\n\t\tr_cachable <= 1'b0;\n\t\tr_svalid <= 1'b0;\n\t\tr_dvalid <= 1'b0;\n\t\tr_cache_miss <= 1'b0;\n\t\tr_addr <= 0;\n\t\tr_rd_pending <= 0;\n\t\tlast_tag_valid <= 0;\n\tend else begin\n\t\t// The single clock path\n\t\t// The valid for the single clock path\n\t\t//\tOnly ... we need to wait if we are currently writing\n\t\t//\tto our cache.\n\t\tr_svalid<= (!i_op[0])&&(!cache_miss_inow)&&(w_cachable)\n\t\t\t\t&&(i_pipe_stb)&&(!c_wr)&&(!wr_cstb);\n\n\t\t//\n\t\t// The two clock in-cache path\n\t\t//\n\t\t// Some preliminaries that needed to be calculated on the first\n\t\t// clock\n\t\tif (!o_busy)\n\t\tbegin\n\t\t\tr_iv   <= c_v[i_cline];\n\t\t\tr_itag <= c_vtags[i_cline];\n\t\t\tr_addr <= i_addr[(AW+1):2];\n\t\t\tr_cachable <= (!i_op[0])&&(w_cachable)&&(i_pipe_stb);\n\t\t\to_wreg <= i_oreg;\n\t\t\tr_rd_pending <= (i_pipe_stb)&&(!i_op[0]);\n\t\tend else begin\n\t\t\tr_iv   <= c_v[r_cline];\n\t\t\tr_itag <= c_vtags[r_cline];\n\t\t\tr_rd_pending <= (r_rd_pending)&&((r_itag != r_ctag)\n\t\t\t\t||(!r_iv)||(!r_cachable))&&(!r_svalid);\n\t\tend\n\t\tr_rd <= (i_pipe_stb)&&(!i_op[0]);\n\t\t// r_itag contains the tag we didn't have available to us on the\n\t\t// last clock, r_ctag is a bit select from r_addr containing a\n\t\t// one clock delayed address.\n\t\tr_dvalid <= (!r_svalid)&&(r_itag == r_ctag)&&(r_iv)&&(r_cachable)&&(r_rd_pending);\n\t\tif ((r_itag == r_ctag)&&(r_iv)&&(r_cachable))\n\t\tbegin\n\t\t\tlast_tag_valid <= 1'b1;\n\t\t\tlast_tag <= r_ctag;\n\t\tend\n\n\t\t// r_cache miss takes a clock cycle.  It is only ever true for\n\t\t// something that should be cachable, but isn't in the cache.\n\t\t// A cache miss is only true _if_\n\t\t// 1. A read was requested\n\t\t// 2. It is for a cachable address, AND\n\t\t// 3. It isn't in the cache on the first read\n\t\t//\tor the second read\n\t\t// 4. The read hasn't yet started to get this address\n\t\tr_cache_miss <= ((!cyc)||(o_wb_we))&&(r_cachable)\n\t\t\t\t// One clock path -- miss\n\t\t\t\t&&(!r_svalid)\n\t\t\t\t// Two clock path -- misses as well\n\t\t\t\t&&(r_rd)&&(!r_svalid)\n\t\t\t\t&&((r_itag != r_ctag)||(!r_iv));\n\tend\n\n\treg\t[DW/8-1:0]\tr_sel;\n\n\tinitial\tr_sel = 4'hf;\n\talways @(posedge i_clk)\n"], "Clone Blocks": [], "Diff Content": {"Delete": [[227, "\t\t\tr_addr <= i_addr[(AW+1):2];\n"], [234, "\t\t\tr_rd_pending <= (r_rd_pending)&&((r_itag != r_ctag)\n"], [235, "\t\t\t\t||(!r_iv)||(!r_cachable))&&(!r_svalid);\n"]], "Add": [[220, "\t\tif ((!o_pipe_stalled)&&(!r_rd_pending))\n"], [220, "\t\t\tr_addr <= i_addr[(AW+1):2];\n"], [235, "\t\t\tr_rd_pending <= (r_rd_pending)&&(!r_svalid)\n"], [235, "\t\t\t\t\t&&(!r_dvalid)\n"], [235, "\t\t\t\t\t&&((r_cachable)||(!i_wb_ack));\n"]]}}