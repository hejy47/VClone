{"Source Block": ["hdl/library/jesd204/jesd204_tx/jesd204_tx.v@368:469@HdlStmIf", "end\n\ngenerate\ngenvar i;\n\nif (LINK_MODE[0] == 1) begin : mode_8b10b\n\nreg [DATA_PATH_WIDTH-1:0] tx_eof_fm_d3;\nreg [DATA_PATH_WIDTH-1:0] tx_eomf_fm_d3;\nwire [NUM_LANES-1:0] lane_cgs_enable;\nwire [DW-1:0] ilas_data;\nwire [DATA_PATH_WIDTH*NUM_LANES-1:0] ilas_charisk;\n\nwire cfg_generate_eomf = 1'b1;\n\nalways @(posedge clk) begin\n  tx_eof_fm_d3 <= tx_eof_fm_d2;\n  tx_eomf_fm_d3 <= tx_eomf_fm_d2;\nend\n\njesd204_tx_ctrl #(\n  .NUM_LANES(NUM_LANES),\n  .NUM_LINKS(NUM_LINKS),\n  .DATA_PATH_WIDTH(DATA_PATH_WIDTH)\n) i_tx_ctrl (\n  .clk(clk),\n  .reset(reset),\n\n  .sync(sync),\n  .lmfc_edge(link_lmfc_edge),\n  .somf(tx_somf_fm_d2),\n  .somf_early2(tx_somf_fm),\n  .eomf(tx_eomf_fm_d2),\n\n  .lane_cgs_enable(lane_cgs_enable),\n  .eof_reset(eof_gen_reset),\n\n  .tx_ready(link_tx_ready),\n  .tx_ready_nx(tx_ready_nx),\n  .tx_next_mf_ready(tx_next_mf_ready),\n\n  .ilas_data(ilas_data),\n  .ilas_charisk(ilas_charisk),\n\n  .ilas_config_addr(ilas_config_addr),\n  .ilas_config_rd(ilas_config_rd),\n  .ilas_config_data(ilas_config_data),\n\n  .cfg_lanes_disable(cfg_lanes_disable),\n  .cfg_links_disable(cfg_links_disable),\n  .cfg_continuous_cgs(cfg_continuous_cgs),\n  .cfg_continuous_ilas(cfg_continuous_ilas),\n  .cfg_skip_ilas(cfg_skip_ilas),\n  .cfg_mframes_per_ilas(cfg_mframes_per_ilas),\n  .cfg_octets_per_multiframe(cfg_octets_per_multiframe),\n  .ctrl_manual_sync_request(ctrl_manual_sync_request),\n\n  .status_sync(status_sync),\n  .status_state(status_state)\n);\n\nfor (i = 0; i < NUM_LANES; i = i + 1) begin: gen_lane\n\n  localparam D_START = i * DATA_PATH_WIDTH*8;\n  localparam D_STOP = D_START + DATA_PATH_WIDTH*8-1;\n  localparam C_START = i * DATA_PATH_WIDTH;\n  localparam C_STOP = C_START + DATA_PATH_WIDTH-1;\n\n  jesd204_tx_lane #(\n    .DATA_PATH_WIDTH(DATA_PATH_WIDTH),\n    .ENABLE_CHAR_REPLACE(ENABLE_CHAR_REPLACE)\n  ) i_lane (\n    .clk(clk),\n\n    .eof(tx_eof_fm_d3),\n    .eomf(tx_eomf_fm_d3),\n\n    .cgs_enable(lane_cgs_enable[i]),\n\n    .ilas_data(ilas_data[D_STOP:D_START]),\n    .ilas_charisk(ilas_charisk[C_STOP:C_START]),\n\n    .tx_data(gearbox_data[D_STOP:D_START]),\n    .tx_ready(link_tx_ready),\n\n    .phy_data(phy_data_r[D_STOP:D_START]),\n    .phy_charisk(phy_charisk_r[C_STOP:C_START]),\n\n    .cfg_octets_per_frame(cfg_octets_per_frame),\n    .cfg_disable_char_replacement(cfg_disable_char_replacement),\n    .cfg_disable_scrambler(cfg_disable_scrambler)\n  );\nend\n\nassign phy_header_r = 'h0;\n\nend\n\nif (LINK_MODE[1] == 1) begin : mode_64b66b\n\n  for (i = 0; i < NUM_LANES; i = i + 1) begin: gen_lane\n    localparam D_START = i * DATA_PATH_WIDTH*8;\n"], "Clone Blocks": [], "Diff Content": {"Delete": [[373, "if (LINK_MODE[0] == 1) begin : mode_8b10b\n"], [375, "reg [DATA_PATH_WIDTH-1:0] tx_eof_fm_d3;\n"], [376, "reg [DATA_PATH_WIDTH-1:0] tx_eomf_fm_d3;\n"], [377, "wire [NUM_LANES-1:0] lane_cgs_enable;\n"], [378, "wire [DW-1:0] ilas_data;\n"], [379, "wire [DATA_PATH_WIDTH*NUM_LANES-1:0] ilas_charisk;\n"], [381, "wire cfg_generate_eomf = 1'b1;\n"], [383, "always @(posedge clk) begin\n"], [384, "  tx_eof_fm_d3 <= tx_eof_fm_d2;\n"], [385, "  tx_eomf_fm_d3 <= tx_eomf_fm_d2;\n"], [386, "end\n"], [388, "jesd204_tx_ctrl #(\n"], [389, "  .NUM_LANES(NUM_LANES),\n"], [390, "  .NUM_LINKS(NUM_LINKS),\n"], [391, "  .DATA_PATH_WIDTH(DATA_PATH_WIDTH)\n"], [392, ") i_tx_ctrl (\n"], [393, "  .clk(clk),\n"], [394, "  .reset(reset),\n"], [396, "  .sync(sync),\n"], [397, "  .lmfc_edge(link_lmfc_edge),\n"], [398, "  .somf(tx_somf_fm_d2),\n"], [399, "  .somf_early2(tx_somf_fm),\n"], [400, "  .eomf(tx_eomf_fm_d2),\n"], [402, "  .lane_cgs_enable(lane_cgs_enable),\n"], [403, "  .eof_reset(eof_gen_reset),\n"], [405, "  .tx_ready(link_tx_ready),\n"], [406, "  .tx_ready_nx(tx_ready_nx),\n"], [407, "  .tx_next_mf_ready(tx_next_mf_ready),\n"], [409, "  .ilas_data(ilas_data),\n"], [410, "  .ilas_charisk(ilas_charisk),\n"], [412, "  .ilas_config_addr(ilas_config_addr),\n"], [413, "  .ilas_config_rd(ilas_config_rd),\n"], [414, "  .ilas_config_data(ilas_config_data),\n"], [416, "  .cfg_lanes_disable(cfg_lanes_disable),\n"], [417, "  .cfg_links_disable(cfg_links_disable),\n"], [418, "  .cfg_continuous_cgs(cfg_continuous_cgs),\n"], [419, "  .cfg_continuous_ilas(cfg_continuous_ilas),\n"], [420, "  .cfg_skip_ilas(cfg_skip_ilas),\n"], [421, "  .cfg_mframes_per_ilas(cfg_mframes_per_ilas),\n"], [422, "  .cfg_octets_per_multiframe(cfg_octets_per_multiframe),\n"], [423, "  .ctrl_manual_sync_request(ctrl_manual_sync_request),\n"], [425, "  .status_sync(status_sync),\n"], [426, "  .status_state(status_state)\n"], [427, ");\n"], [429, "for (i = 0; i < NUM_LANES; i = i + 1) begin: gen_lane\n"], [431, "  localparam D_START = i * DATA_PATH_WIDTH*8;\n"], [432, "  localparam D_STOP = D_START + DATA_PATH_WIDTH*8-1;\n"], [433, "  localparam C_START = i * DATA_PATH_WIDTH;\n"], [434, "  localparam C_STOP = C_START + DATA_PATH_WIDTH-1;\n"], [436, "  jesd204_tx_lane #(\n"], [437, "    .DATA_PATH_WIDTH(DATA_PATH_WIDTH),\n"], [438, "    .ENABLE_CHAR_REPLACE(ENABLE_CHAR_REPLACE)\n"], [439, "  ) i_lane (\n"], [440, "    .clk(clk),\n"], [442, "    .eof(tx_eof_fm_d3),\n"], [443, "    .eomf(tx_eomf_fm_d3),\n"], [445, "    .cgs_enable(lane_cgs_enable[i]),\n"], [447, "    .ilas_data(ilas_data[D_STOP:D_START]),\n"], [448, "    .ilas_charisk(ilas_charisk[C_STOP:C_START]),\n"], [450, "    .tx_data(gearbox_data[D_STOP:D_START]),\n"], [451, "    .tx_ready(link_tx_ready),\n"], [453, "    .phy_data(phy_data_r[D_STOP:D_START]),\n"], [454, "    .phy_charisk(phy_charisk_r[C_STOP:C_START]),\n"], [456, "    .cfg_octets_per_frame(cfg_octets_per_frame),\n"], [457, "    .cfg_disable_char_replacement(cfg_disable_char_replacement),\n"], [458, "    .cfg_disable_scrambler(cfg_disable_scrambler)\n"], [459, "  );\n"], [460, "end\n"], [462, "assign phy_header_r = 'h0;\n"], [464, "end\n"]], "Add": [[427, "  assign frame_mark_reset = (LINK_MODE == 1) ? eof_gen_reset : ~tx_ready_64b_next;\n"], [429, "  jesd204_frame_mark #(\n"], [429, "    .DATA_PATH_WIDTH            (DATA_PATH_WIDTH)\n"], [429, "  ) i_frame_mark (\n"], [429, "    .clk                        (clk),\n"], [429, "    .reset                      (frame_mark_reset),\n"], [429, "    .cfg_octets_per_multiframe  (cfg_octets_per_multiframe),\n"], [429, "    .cfg_beats_per_multiframe   (cfg_beats_per_multiframe),\n"], [429, "    .cfg_octets_per_frame       (cfg_octets_per_frame),\n"], [429, "    .sof                        (tx_sof_fm),\n"], [429, "    .eof                        (tx_eof_fm),\n"], [429, "    .somf                       (tx_somf_fm),\n"], [429, "    .eomf                       (tx_eomf_fm));\n"], [434, "  always @(posedge clk) begin\n"], [434, "    tx_sof_fm_d1  <= tx_sof_fm;\n"], [434, "    tx_eof_fm_d1  <= tx_eof_fm;\n"], [434, "    tx_somf_fm_d1 <= tx_somf_fm;\n"], [434, "    tx_eomf_fm_d1 <= tx_eomf_fm;\n"], [434, "    tx_sof_fm_d2  <= tx_sof_fm_d1;\n"], [434, "    tx_eof_fm_d2  <= tx_eof_fm_d1;\n"], [434, "    tx_somf_fm_d2 <= tx_somf_fm_d1;\n"], [434, "    tx_eomf_fm_d2 <= tx_eomf_fm_d1;\n"], [434, "  end\n"], [440, "  generate\n"], [440, "  genvar i;\n"], [443, "  if (LINK_MODE[0] == 1) begin : mode_8b10b\n"], [445, "  reg [DATA_PATH_WIDTH-1:0] tx_eof_fm_d3;\n"], [445, "  reg [DATA_PATH_WIDTH-1:0] tx_eomf_fm_d3;\n"], [445, "  wire [NUM_LANES-1:0] lane_cgs_enable;\n"], [445, "  wire [DW-1:0] ilas_data;\n"], [445, "  wire [DATA_PATH_WIDTH*NUM_LANES-1:0] ilas_charisk;\n"], [448, "  wire cfg_generate_eomf = 1'b1;\n"], [451, "  always @(posedge clk) begin\n"], [451, "    tx_eof_fm_d3 <= tx_eof_fm_d2;\n"], [451, "    tx_eomf_fm_d3 <= tx_eomf_fm_d2;\n"], [451, "  end\n"], [454, "  jesd204_tx_ctrl #(\n"], [454, "    .NUM_LANES(NUM_LANES),\n"], [454, "    .NUM_LINKS(NUM_LINKS),\n"], [454, "    .DATA_PATH_WIDTH(DATA_PATH_WIDTH)\n"], [454, "  ) i_tx_ctrl (\n"], [454, "    .clk(clk),\n"], [454, "    .reset(reset),\n"], [460, "    .sync(sync),\n"], [460, "    .lmfc_edge(link_lmfc_edge),\n"], [460, "    .somf(tx_somf_fm_d2),\n"], [460, "    .somf_early2(tx_somf_fm),\n"], [460, "    .eomf(tx_eomf_fm_d2),\n"], [462, "    .lane_cgs_enable(lane_cgs_enable),\n"], [462, "    .eof_reset(eof_gen_reset),\n"], [464, "    .tx_ready(link_tx_ready),\n"], [464, "    .tx_ready_nx(tx_ready_nx),\n"], [464, "    .tx_next_mf_ready(tx_next_mf_ready),\n"], [464, "    .ilas_data(ilas_data),\n"], [464, "    .ilas_charisk(ilas_charisk),\n"], [464, "    .ilas_config_addr(ilas_config_addr),\n"], [464, "    .ilas_config_rd(ilas_config_rd),\n"], [464, "    .ilas_config_data(ilas_config_data),\n"], [464, "    .cfg_lanes_disable(cfg_lanes_disable),\n"], [464, "    .cfg_links_disable(cfg_links_disable),\n"], [464, "    .cfg_continuous_cgs(cfg_continuous_cgs),\n"], [464, "    .cfg_continuous_ilas(cfg_continuous_ilas),\n"], [464, "    .cfg_skip_ilas(cfg_skip_ilas),\n"], [464, "    .cfg_mframes_per_ilas(cfg_mframes_per_ilas),\n"], [464, "    .cfg_octets_per_multiframe(cfg_octets_per_multiframe),\n"], [464, "    .ctrl_manual_sync_request(ctrl_manual_sync_request),\n"]]}}