{"Source Block": ["hdl/library/jesd204/jesd204_common/jesd204_lmfc.v@107:123@HdlStmProcess", "  sysref_d1 <= sysref_r;\n  sysref_d2 <= sysref_d1;\n  sysref_d3 <= sysref_d2;\nend\n\nalways @(posedge clk) begin\n  if (sysref_d3 == 1'b0 && sysref_d2 == 1'b1 && cfg_sysref_disable == 1'b0) begin\n    sysref_edge <= 1'b1;\n  end else begin\n    sysref_edge <= 1'b0;\n  end\nend\n\nalways @(posedge clk) begin\n  if (reset == 1'b1) begin\n    sysref_captured <= 1'b0;\n  end else if (sysref_edge == 1'b1) begin\n"], "Clone Blocks": [], "Diff Content": {"Delete": [[112, "always @(posedge clk) begin\n"], [113, "  if (sysref_d3 == 1'b0 && sysref_d2 == 1'b1 && cfg_sysref_disable == 1'b0) begin\n"], [114, "    sysref_edge <= 1'b1;\n"], [115, "  end else begin\n"], [116, "    sysref_edge <= 1'b0;\n"], [118, "end\n"]], "Add": [[116, "  localparam DPW_LOG2 = DATA_PATH_WIDTH == 8 ? 3 : DATA_PATH_WIDTH == 4 ? 2 : 1;\n"], [116, "  localparam BEATS_PER_MF_WIDTH = 10-DPW_LOG2;\n"], [116, "  reg  [BEATS_PER_MF_WIDTH:0]       cfg_whole_beats_per_multiframe;\n"], [116, "  reg sysref_r = 1'b0;\n"], [116, "  reg sysref_d1 = 1'b0;\n"], [116, "  reg sysref_d2 = 1'b0;\n"], [116, "  reg sysref_d3 = 1'b0;\n"], [116, "  reg sysref_captured;\n"], [116, "  /* lmfc_octet_counter = lmfc_counter * (char_clock_rate / device_clock_rate) */\n"], [116, "  reg [7:0] lmfc_counter_next = 'h00;\n"], [116, "  reg lmfc_clk_p1 = 1'b1;\n"], [116, "  reg lmfc_active = 1'b0;\n"], [116, "  always @(posedge clk) begin\n"], [116, "    sysref_r <= sysref;\n"], [116, "  end\n"], [116, "  /*\n"], [116, "   * Unfortunately setup and hold are often ignored on the sysref signal relative\n"], [116, "   * to the device clock. The device will often still work fine, just not\n"], [116, "   * deterministic. Reduce the probability that the meta-stability creeps into the\n"], [116, "   * reset of the system and causes non-reproducible issues.\n"], [116, "   */\n"], [116, "  always @(posedge clk) begin\n"], [116, "    sysref_d1 <= sysref_r;\n"], [116, "    sysref_d2 <= sysref_d1;\n"], [116, "    sysref_d3 <= sysref_d2;\n"]]}}